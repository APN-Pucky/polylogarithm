#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN 1

#include "doctest.h"
#include "Li2.hpp"
#include "Li3.hpp"
#include "Li4.hpp"
#include "Li5.hpp"
#include "Li6.hpp"
#include "Li.hpp"
#include "read_data.hpp"
#include <cmath>
#include <utility>

#define CHECK_CLOSE(a,b,eps) CHECK((a) == doctest::Approx(b).epsilon(eps))
#define CHECK_CLOSE_COMPLEX(a,b,eps) do {                               \
      CHECK_CLOSE(std::real(a), std::real(b), (eps));                   \
      CHECK_CLOSE(std::imag(a), std::imag(b), (eps));                   \
   } while (0)
#define CHECK_SMALL(a,eps) CHECK(std::abs(a) < (eps))

const std::pair<std::complex<double>, std::complex<double>> values_close_to_unity[] = {
 {{0.9, -0.1}, {0.9, -0.1}}, {{0.9, -0.01}, {0.9, -0.01}},
 {{0.9, -0.001}, {0.9, -0.001}}, {{0.9, -0.0001}, {0.9, -0.0001}},
 {{0.9, -0.00001}, {0.9, -0.00001}}, {{0.9, -1.e-6}, {0.9, -1.e-6}},
 {{0.9, -1.e-7}, {0.9, -1.e-7}}, {{0.9, -1.e-8}, {0.9, -1.e-8}},
 {{0.9, -1.e-9}, {0.9, -1.e-9}}, {{0.9, -1.e-10}, {0.9, -1.e-10}},
 {{0.9, 0.}, {0.9, 0.}}, {{0.9, 0.1}, {0.9, 0.1}},
 {{0.9, 0.01}, {0.9, 0.01}}, {{0.9, 0.001}, {0.9, 0.001}},
 {{0.9, 0.0001}, {0.9, 0.0001}}, {{0.9, 0.00001}, {0.9, 0.00001}},
 {{0.9, 1.e-6}, {0.9, 1.e-6}}, {{0.9, 1.e-7}, {0.9, 1.e-7}},
 {{0.9, 1.e-8}, {0.9, 1.e-8}}, {{0.9, 1.e-9}, {0.9, 1.e-9}},
 {{0.9, 1.e-10}, {0.9, 1.e-10}}, {{0.9, 0.}, {0.9, 0.}},
 {{0.99, -0.1}, {0.99, -0.1}}, {{0.99, -0.01}, {0.99, -0.01}},
 {{0.99, -0.001}, {0.99, -0.001}}, {{0.99, -0.0001}, {0.99, -0.0001}},
 {{0.99, -0.00001}, {0.99, -0.00001}}, {{0.99, -1.e-6}, {0.99, -1.e-6}},
 {{0.99, -1.e-7}, {0.99, -1.e-7}}, {{0.99, -1.e-8}, {0.99, -1.e-8}},
 {{0.99, -1.e-9}, {0.99, -1.e-9}}, {{0.99, -1.e-10}, {0.99, -1.e-10}},
 {{0.99, 0.}, {0.99, 0.}}, {{0.99, 0.1}, {0.99, 0.1}},
 {{0.99, 0.01}, {0.99, 0.01}}, {{0.99, 0.001}, {0.99, 0.001}},
 {{0.99, 0.0001}, {0.99, 0.0001}}, {{0.99, 0.00001}, {0.99, 0.00001}},
 {{0.99, 1.e-6}, {0.99, 1.e-6}}, {{0.99, 1.e-7}, {0.99, 1.e-7}},
 {{0.99, 1.e-8}, {0.99, 1.e-8}}, {{0.99, 1.e-9}, {0.99, 1.e-9}},
 {{0.99, 1.e-10}, {0.99, 1.e-10}}, {{0.99, 0.}, {0.99, 0.}},
 {{0.999, -0.1}, {0.9990000000000002, -0.1}},
 {{0.999, -0.01}, {0.999, -0.01}}, {{0.999, -0.001}, {0.999, -0.001}},
 {{0.999, -0.0001}, {0.999, -0.0001}}, {{0.999, -0.00001},
  {0.999, -0.00001}}, {{0.999, -1.e-6}, {0.999, -1.e-6}},
 {{0.999, -1.e-7}, {0.999, -1.e-7}}, {{0.999, -1.e-8}, {0.999, -1.e-8}},
 {{0.999, -1.e-9}, {0.999, -1.e-9}}, {{0.999, -1.e-10},
  {0.999, -1.e-10}}, {{0.999, 0.}, {0.999, 0.}},
 {{0.999, 0.1}, {0.9990000000000002, 0.1}}, {{0.999, 0.01}, {0.999, 0.01}},
 {{0.999, 0.001}, {0.999, 0.001}}, {{0.999, 0.0001}, {0.999, 0.0001}},
 {{0.999, 0.00001}, {0.999, 0.00001}}, {{0.999, 1.e-6}, {0.999, 1.e-6}},
 {{0.999, 1.e-7}, {0.999, 1.e-7}}, {{0.999, 1.e-8}, {0.999, 1.e-8}},
 {{0.999, 1.e-9}, {0.999, 1.e-9}}, {{0.999, 1.e-10}, {0.999, 1.e-10}},
 {{0.999, 0.}, {0.999, 0.}}, {{0.9999, -0.1}, {0.9999000000000002, -0.1}},
 {{0.9999, -0.01}, {0.9999, -0.01}}, {{0.9999, -0.001}, {0.9999, -0.001}},
 {{0.9999, -0.0001}, {0.9999, -0.0001}}, {{0.9999, -0.00001},
  {0.9999, -0.00001}}, {{0.9999, -1.e-6}, {0.9999, -1.e-6}},
 {{0.9999, -1.e-7}, {0.9999, -1.e-7}}, {{0.9999, -1.e-8},
  {0.9999, -1.e-8}}, {{0.9999, -1.e-9}, {0.9999, -1.e-9}},
 {{0.9999, -1.e-10}, {0.9999, -1.e-10}}, {{0.9999, 0.}, {0.9999, 0.}},
 {{0.9999, 0.1}, {0.9999000000000002, 0.1}},
 {{0.9999, 0.01}, {0.9999, 0.01}}, {{0.9999, 0.001}, {0.9999, 0.001}},
 {{0.9999, 0.0001}, {0.9999, 0.0001}}, {{0.9999, 0.00001},
  {0.9999, 0.00001}}, {{0.9999, 1.e-6}, {0.9999, 1.e-6}},
 {{0.9999, 1.e-7}, {0.9999, 1.e-7}}, {{0.9999, 1.e-8}, {0.9999, 1.e-8}},
 {{0.9999, 1.e-9}, {0.9999, 1.e-9}}, {{0.9999, 1.e-10},
  {0.9999, 1.e-10}}, {{0.9999, 0.}, {0.9999, 0.}},
 {{0.99999, -0.1}, {0.9999899999999997, -0.10000000000000003}},
 {{0.99999, -0.01}, {0.9999900000000005, -0.01}},
 {{0.99999, -0.001}, {0.99999, -0.001}}, {{0.99999, -0.0001},
  {0.99999, -0.0001}}, {{0.99999, -0.00001}, {0.99999, -0.00001}},
 {{0.99999, -1.e-6}, {0.99999, -1.e-6}}, {{0.99999, -1.e-7},
  {0.99999, -1.e-7}}, {{0.99999, -1.e-8}, {0.99999, -1.e-8}},
 {{0.99999, -1.e-9}, {0.99999, -1.e-9}}, {{0.99999, -1.e-10},
  {0.99999, -1.e-10}}, {{0.99999, 0.}, {0.99999, 0.}},
 {{0.99999, 0.1}, {0.9999899999999997, 0.10000000000000003}},
 {{0.99999, 0.01}, {0.9999900000000005, 0.01}},
 {{0.99999, 0.001}, {0.99999, 0.001}}, {{0.99999, 0.0001},
  {0.99999, 0.0001}}, {{0.99999, 0.00001}, {0.99999, 0.00001}},
 {{0.99999, 1.e-6}, {0.99999, 1.e-6}}, {{0.99999, 1.e-7},
  {0.99999, 1.e-7}}, {{0.99999, 1.e-8}, {0.99999, 1.e-8}},
 {{0.99999, 1.e-9}, {0.99999, 1.e-9}}, {{0.99999, 1.e-10},
  {0.99999, 1.e-10}}, {{0.99999, 0.}, {0.99999, 0.}},
 {{0.999999, -0.1}, {0.999999, -0.10000000000000003}},
 {{0.999999, -0.01}, {0.9999990000000002, -0.009999999999999998}},
 {{0.999999, -0.001}, {0.999999, -0.001}}, {{0.999999, -0.0001},
  {0.999999, -0.0001}}, {{0.999999, -0.00001}, {0.999999, -0.00001}},
 {{0.999999, -1.e-6}, {0.999999, -1.e-6}},
 {{0.999999, -1.e-7}, {0.999999, -1.e-7}},
 {{0.999999, -1.e-8}, {0.999999, -1.e-8}},
 {{0.999999, -1.e-9}, {0.999999, -1.e-9}},
 {{0.999999, -1.e-10}, {0.999999, -1.e-10}},
 {{0.999999, 0.}, {0.999999, 0.}}, {{0.999999, 0.1},
  {0.999999, 0.10000000000000003}}, {{0.999999, 0.01},
  {0.9999990000000002, 0.009999999999999998}},
 {{0.999999, 0.001}, {0.999999, 0.001}}, {{0.999999, 0.0001},
  {0.999999, 0.0001}}, {{0.999999, 0.00001}, {0.999999, 0.00001}},
 {{0.999999, 1.e-6}, {0.999999, 1.e-6}}, {{0.999999, 1.e-7},
  {0.999999, 1.e-7}}, {{0.999999, 1.e-8}, {0.999999, 1.e-8}},
 {{0.999999, 1.e-9}, {0.999999, 1.e-9}}, {{0.999999, 1.e-10},
  {0.999999, 1.e-10}}, {{0.999999, 0.}, {0.999999, 0.}},
 {{0.9999999, -0.1}, {0.9999998999999993, -0.1}},
 {{0.9999999, -0.01}, {0.9999998999999994, -0.009999999999999998}},
 {{0.9999999, -0.001}, {0.9999998999999995, -0.001}},
 {{0.9999999, -0.0001}, {0.9999999, -0.0001}},
 {{0.9999999, -0.00001}, {0.9999999, -0.00001}},
 {{0.9999999, -1.e-6}, {0.9999999, -1.e-6}},
 {{0.9999999, -1.e-7}, {0.9999999, -1.e-7}},
 {{0.9999999, -1.e-8}, {0.9999999, -1.e-8}},
 {{0.9999999, -1.e-9}, {0.9999999, -1.e-9}},
 {{0.9999999, -1.e-10}, {0.9999999, -1.e-10}},
 {{0.9999999, 0.}, {0.9999999, 0.}}, {{0.9999999, 0.1},
  {0.9999998999999993, 0.1}}, {{0.9999999, 0.01},
  {0.9999998999999994, 0.009999999999999998}},
 {{0.9999999, 0.001}, {0.9999998999999995, 0.001}},
 {{0.9999999, 0.0001}, {0.9999999, 0.0001}},
 {{0.9999999, 0.00001}, {0.9999999, 0.00001}},
 {{0.9999999, 1.e-6}, {0.9999999, 1.e-6}},
 {{0.9999999, 1.e-7}, {0.9999999, 1.e-7}},
 {{0.9999999, 1.e-8}, {0.9999999, 1.e-8}},
 {{0.9999999, 1.e-9}, {0.9999999, 1.e-9}},
 {{0.9999999, 1.e-10}, {0.9999999, 1.e-10}},
 {{0.9999999, 0.}, {0.9999999, 0.}}, {{0.99999999, -0.1},
  {0.9999999899999998, -0.10000000000000002}},
 {{0.99999999, -0.01}, {0.9999999900000013, -0.009999999999999998}},
 {{0.99999999, -0.001}, {0.9999999900000001, -0.0010000000000000002}},
 {{0.99999999, -0.0001}, {0.99999999, -0.0001}},
 {{0.99999999, -0.00001}, {0.99999999, -0.00001}},
 {{0.99999999, -1.e-6}, {0.99999999, -1.e-6}},
 {{0.99999999, -1.e-7}, {0.99999999, -1.e-7}},
 {{0.99999999, -1.e-8}, {0.99999999, -1.e-8}},
 {{0.99999999, -1.e-9}, {0.99999999, -1.e-9}},
 {{0.99999999, -1.e-10}, {0.99999999, -1.e-10}},
 {{0.99999999, 0.}, {0.99999999, 0.}}, {{0.99999999, 0.1},
  {0.9999999899999998, 0.10000000000000002}},
 {{0.99999999, 0.01}, {0.9999999900000013, 0.009999999999999998}},
 {{0.99999999, 0.001}, {0.9999999900000001, 0.0010000000000000002}},
 {{0.99999999, 0.0001}, {0.99999999, 0.0001}},
 {{0.99999999, 0.00001}, {0.99999999, 0.00001}},
 {{0.99999999, 1.e-6}, {0.99999999, 1.e-6}},
 {{0.99999999, 1.e-7}, {0.99999999, 1.e-7}},
 {{0.99999999, 1.e-8}, {0.99999999, 1.e-8}},
 {{0.99999999, 1.e-9}, {0.99999999, 1.e-9}},
 {{0.99999999, 1.e-10}, {0.99999999, 1.e-10}},
 {{0.99999999, 0.}, {0.99999999, 0.}}, {{0.999999999, -0.1},
  {0.9999999990000005, -0.09999999999999999}},
 {{0.999999999, -0.01}, {0.9999999989999991, -0.01}},
 {{0.999999999, -0.001}, {0.9999999990000003, -0.0009999999999999998}},
 {{0.999999999, -0.0001}, {0.9999999990000009, -0.00009999999999999996}},
 {{0.999999999, -0.00001}, {0.999999999, -0.00001}},
 {{0.999999999, -1.e-6}, {0.999999999, -1.e-6}},
 {{0.999999999, -1.e-7}, {0.999999999, -1.e-7}},
 {{0.999999999, -1.e-8}, {0.999999999, -1.e-8}},
 {{0.999999999, -1.e-9}, {0.999999999, -1.e-9}},
 {{0.999999999, -1.e-10}, {0.999999999, -1.e-10}},
 {{0.999999999, 0.}, {0.999999999, 0.}}, {{0.999999999, 0.1},
  {0.9999999990000005, 0.09999999999999999}},
 {{0.999999999, 0.01}, {0.9999999989999991, 0.01}},
 {{0.999999999, 0.001}, {0.9999999990000003, 0.0009999999999999998}},
 {{0.999999999, 0.0001}, {0.9999999990000009, 0.00009999999999999996}},
 {{0.999999999, 0.00001}, {0.999999999, 0.00001}},
 {{0.999999999, 1.e-6}, {0.999999999, 1.e-6}},
 {{0.999999999, 1.e-7}, {0.999999999, 1.e-7}},
 {{0.999999999, 1.e-8}, {0.999999999, 1.e-8}},
 {{0.999999999, 1.e-9}, {0.999999999, 1.e-9}},
 {{0.999999999, 1.e-10}, {0.999999999, 1.e-10}},
 {{0.999999999, 0.}, {0.999999999, 0.}}, {{0.9999999999, -0.1},
  {0.9999999999000007, -0.09999999999999998}},
 {{0.9999999999, -0.01}, {0.9999999999000007, -0.01}},
 {{0.9999999999, -0.001}, {0.9999999999000008, -0.001}},
 {{0.9999999999, -0.0001}, {0.9999999998999999, -0.00010000000000000002}},
 {{0.9999999999, -0.00001}, {0.9999999999, -0.00001}},
 {{0.9999999999, -1.e-6}, {0.9999999999, -1.e-6}},
 {{0.9999999999, -1.e-7}, {0.9999999999, -1.e-7}},
 {{0.9999999999, -1.e-8}, {0.9999999999, -1.e-8}},
 {{0.9999999999, -1.e-9}, {0.9999999999, -1.e-9}},
 {{0.9999999999, -1.e-10}, {0.9999999999, -1.e-10}},
 {{0.9999999999, 0.}, {0.9999999999, 0.}}, {{0.9999999999, 0.1},
  {0.9999999999000007, 0.09999999999999998}},
 {{0.9999999999, 0.01}, {0.9999999999000007, 0.01}},
 {{0.9999999999, 0.001}, {0.9999999999000008, 0.001}},
 {{0.9999999999, 0.0001}, {0.9999999998999999, 0.00010000000000000002}},
 {{0.9999999999, 0.00001}, {0.9999999999, 0.00001}},
 {{0.9999999999, 1.e-6}, {0.9999999999, 1.e-6}},
 {{0.9999999999, 1.e-7}, {0.9999999999, 1.e-7}},
 {{0.9999999999, 1.e-8}, {0.9999999999, 1.e-8}},
 {{0.9999999999, 1.e-9}, {0.9999999999, 1.e-9}},
 {{0.9999999999, 1.e-10}, {0.9999999999, 1.e-10}},
 {{0.9999999999, 0.}, {0.9999999999, 0.}},
 {{1., -0.1}, {0.9999999999999996, -0.09999999999999999}},
 {{1., -0.01}, {0.9999999999999989, -0.009999999999999998}},
 {{1., -0.001}, {0.9999999999999999, -0.0010000000000000002}},
 {{1., -0.0001}, {0.9999999999999994, -0.0001}},
 {{1., -0.00001}, {0.9999999999999996, -0.00001}},
 {{1., -1.e-6}, {1., -1.e-6}}, {{1., -1.e-7},
  {0.9999999999999993, -9.999999999999998e-8}},
 {{1., -1.e-8}, {1., -1.e-8}}, {{1., -1.e-9}, {1., -1.e-9}},
 {{1., -1.e-10}, {1., -1.e-10}}, {{1., 0.}, {0.999999999999995, 0.}},
 {{1., 0.1}, {0.9999999999999996, 0.09999999999999999}},
 {{1., 0.01}, {0.9999999999999989, 0.009999999999999998}},
 {{1., 0.001}, {0.9999999999999999, 0.0010000000000000002}},
 {{1., 0.0001}, {0.9999999999999994, 0.0001}},
 {{1., 0.00001}, {0.9999999999999996, 0.00001}},
 {{1., 1.e-6}, {1., 1.e-6}}, {{1., 1.e-7},
  {0.9999999999999993, 9.999999999999998e-8}}, {{1., 1.e-8}, {1., 1.e-8}},
 {{1., 1.e-9}, {1., 1.e-9}}, {{1., 1.e-10}, {1., 1.e-10}},
 {{1., 0.}, {0.999999999999995, 0.}},
 {{1.1, -0.1}, {1.1, -0.09999999999999992}},
 {{1.1, -0.01}, {1.0999999999999999, -0.009999999999999997}},
 {{1.1, -0.001}, {1.1, -0.0010000000000000195}},
 {{1.1, -0.0001}, {1.0999999999999999, -0.0000999999999999532}},
 {{1.1, -0.00001}, {1.1, -9.99999999992897e-6}},
 {{1.1, -1.e-6}, {1.0999999999999992, -9.99999999970218e-7}},
 {{1.1, -1.e-7}, {1.100000000000001, -1.0000000004836482e-7}},
 {{1.1, -1.e-8}, {1.1, -9.999999970094662e-9}},
 {{1.1, -1.e-9}, {1.0999999999999996, -1.0000000459915014e-9}},
 {{1.1, -1.e-10}, {1.100000000000001, -9.999998891757926e-11}},
 {{1.1, 0.}, {1.0999999999999996, 4.3451803329710894e-18}},
 {{1.1, 0.1}, {1.1, 0.09999999999999992}},
 {{1.1, 0.01}, {1.0999999999999999, 0.009999999999999997}},
 {{1.1, 0.001}, {1.1, 0.0010000000000000195}},
 {{1.1, 0.0001}, {1.0999999999999999, 0.0000999999999999532}},
 {{1.1, 0.00001}, {1.1, 9.99999999992897e-6}},
 {{1.1, 1.e-6}, {1.0999999999999992, 9.99999999970218e-7}},
 {{1.1, 1.e-7}, {1.100000000000001, 1.0000000004836482e-7}},
 {{1.1, 1.e-8}, {1.1, 9.999999970094662e-9}},
 {{1.1, 1.e-9}, {1.0999999999999996, 1.0000000459915014e-9}},
 {{1.1, 1.e-10}, {1.100000000000001, 9.999998891757926e-11}},
 {{1.1, 0.}, {1.0999999999999996, 4.3451803329710894e-18}},
 {{1.01, -0.1}, {1.0099999999999998, -0.1}},
 {{1.01, -0.01}, {1.0100000000000007, -0.009999999999999992}},
 {{1.01, -0.001}, {1.0099999999999998, -0.000999999999999995}},
 {{1.01, -0.0001}, {1.0100000000000002, -0.00010000000000000003}},
 {{1.01, -0.00001}, {1.0099999999999996, -9.999999999992008e-6}},
 {{1.01, -1.e-6}, {1.0099999999999991, -9.999999999959272e-7}},
 {{1.01, -1.e-7}, {1.0100000000000002, -1.0000000001344687e-7}},
 {{1.01, -1.e-8}, {1.0099999999999993, -9.999999996764712e-9}},
 {{1.01, -1.e-9}, {1.0100000000000007, -9.999999969094426e-10}},
 {{1.01, -1.e-10}, {1.0100000000000002, -9.999998651675191e-11}},
 {{1.01, 0.}, {1.0100000000000007, 2.510917698224461e-18}},
 {{1.01, 0.1}, {1.0099999999999998, 0.1}},
 {{1.01, 0.01}, {1.0100000000000007, 0.009999999999999992}},
 {{1.01, 0.001}, {1.0099999999999998, 0.000999999999999995}},
 {{1.01, 0.0001}, {1.0100000000000002, 0.00010000000000000003}},
 {{1.01, 0.00001}, {1.0099999999999996, 9.999999999992008e-6}},
 {{1.01, 1.e-6}, {1.0099999999999991, 9.999999999959272e-7}},
 {{1.01, 1.e-7}, {1.0100000000000002, 1.0000000001344687e-7}},
 {{1.01, 1.e-8}, {1.0099999999999993, 9.999999996764712e-9}},
 {{1.01, 1.e-9}, {1.0100000000000007, 9.999999969094426e-10}},
 {{1.01, 1.e-10}, {1.0100000000000002, 9.999998651675191e-11}},
 {{1.01, 0.}, {1.0100000000000007, 2.510917698224461e-18}},
 {{1.001, -0.1}, {1.0010000000000001, -0.1}},
 {{1.001, -0.01}, {1.0009999999999992, -0.01}},
 {{1.001, -0.001}, {1.001, -0.001}}, {{1.001, -0.0001},
  {1.0009999999999994, -0.0001000000000000002}},
 {{1.001, -0.00001}, {1.0009999999999994, -9.999999999999449e-6}},
 {{1.001, -1.e-6}, {1.0009999999999988, -1.0000000000004891e-6}},
 {{1.001, -1.e-7}, {1.001, -9.999999999985865e-8}},
 {{1.001, -1.e-8}, {1.0009999999999992, -1.0000000000137016e-8}},
 {{1.001, -1.e-9}, {1.0009999999999997, -9.999999995080834e-10}},
 {{1.001, -1.e-10}, {1.0009999999999997, -9.999999944097578e-11}},
 {{1.001, 0.}, {1.0010000000000001, 5.1507650730409545e-19}},
 {{1.001, 0.1}, {1.0010000000000001, 0.1}},
 {{1.001, 0.01}, {1.0009999999999992, 0.01}},
 {{1.001, 0.001}, {1.001, 0.001}}, {{1.001, 0.0001},
  {1.0009999999999994, 0.0001000000000000002}},
 {{1.001, 0.00001}, {1.0009999999999994, 9.999999999999449e-6}},
 {{1.001, 1.e-6}, {1.0009999999999988, 1.0000000000004891e-6}},
 {{1.001, 1.e-7}, {1.001, 9.999999999985865e-8}},
 {{1.001, 1.e-8}, {1.0009999999999992, 1.0000000000137016e-8}},
 {{1.001, 1.e-9}, {1.0009999999999997, 9.999999995080834e-10}},
 {{1.001, 1.e-10}, {1.0009999999999997, 9.999999944097578e-11}},
 {{1.001, 0.}, {1.0010000000000001, 5.1507650730409545e-19}},
 {{1.0001, -0.1}, {1.0001000000000007, -0.09999999999999998}},
 {{1.0001, -0.01}, {1.0000999999999995, -0.01}},
 {{1.0001, -0.001}, {1.0001000000000007, -0.0010000000000000002}},
 {{1.0001, -0.0001}, {1.0001000000000007, -0.00010000000000000006}},
 {{1.0001, -0.00001}, {1.0001000000000004, -0.000010000000000000041}},
 {{1.0001, -1.e-6}, {1.0000999999999993, -1.000000000000145e-6}},
 {{1.0001, -1.e-7}, {1.0001, -9.999999999988837e-8}},
 {{1.0001, -1.e-8}, {1.0001000000000007, -9.999999999914835e-9}},
 {{1.0001, -1.e-9}, {1.0001000000000002, -9.999999999319798e-10}},
 {{1.0001, -1.e-10}, {1.0000999999999998, -9.999999997818313e-11}},
 {{1.0001, 0.}, {1.0001000000000007, -2.714852822005776e-20}},
 {{1.0001, 0.1}, {1.0001000000000007, 0.09999999999999998}},
 {{1.0001, 0.01}, {1.0000999999999995, 0.01}},
 {{1.0001, 0.001}, {1.0001000000000007, 0.0010000000000000002}},
 {{1.0001, 0.0001}, {1.0001000000000007, 0.00010000000000000006}},
 {{1.0001, 0.00001}, {1.0001000000000004, 0.000010000000000000041}},
 {{1.0001, 1.e-6}, {1.0000999999999993, 1.000000000000145e-6}},
 {{1.0001, 1.e-7}, {1.0001, 9.999999999988837e-8}},
 {{1.0001, 1.e-8}, {1.0001000000000007, 9.999999999914835e-9}},
 {{1.0001, 1.e-9}, {1.0001000000000002, 9.999999999319798e-10}},
 {{1.0001, 1.e-10}, {1.0000999999999998, 9.999999997818313e-11}},
 {{1.0001, 0.}, {1.0001000000000007, -2.714852822005776e-20}},
 {{1.00001, -0.1}, {1.000010000000001, -0.10000000000000002}},
 {{1.00001, -0.01}, {1.00001, -0.01}}, {{1.00001, -0.001},
  {1.00001, -0.0009999999999999998}}, {{1.00001, -0.0001},
  {1.0000100000000005, -0.0001}}, {{1.00001, -0.00001},
  {1.0000100000000005, -0.000010000000000000003}},
 {{1.00001, -1.e-6}, {1.00001, -9.999999999999978e-7}},
 {{1.00001, -1.e-7}, {1.000010000000001, -9.999999999999597e-8}},
 {{1.00001, -1.e-8}, {1.00001, -9.999999999997851e-9}},
 {{1.00001, -1.e-9}, {1.0000099999999996, -1.0000000000023848e-9}},
 {{1.00001, -1.e-10}, {1.000010000000001, -9.999999999681723e-11}},
 {{1.00001, 0.}, {1.0000100000000005, -9.868619257088694e-21}},
 {{1.00001, 0.1}, {1.000010000000001, 0.10000000000000002}},
 {{1.00001, 0.01}, {1.00001, 0.01}}, {{1.00001, 0.001},
  {1.00001, 0.0009999999999999998}}, {{1.00001, 0.0001},
  {1.0000100000000005, 0.0001}}, {{1.00001, 0.00001},
  {1.0000100000000005, 0.000010000000000000003}},
 {{1.00001, 1.e-6}, {1.00001, 9.999999999999978e-7}},
 {{1.00001, 1.e-7}, {1.000010000000001, 9.999999999999597e-8}},
 {{1.00001, 1.e-8}, {1.00001, 9.999999999997851e-9}},
 {{1.00001, 1.e-9}, {1.0000099999999996, 1.0000000000023848e-9}},
 {{1.00001, 1.e-10}, {1.000010000000001, 9.999999999681723e-11}},
 {{1.00001, 0.}, {1.0000100000000005, -9.868619257088694e-21}},
 {{1.000001, -0.1}, {1.0000010000000001, -0.09999999999999999}},
 {{1.000001, -0.01}, {1.0000010000000004, -0.01}},
 {{1.000001, -0.001}, {1.0000010000000001, -0.001}},
 {{1.000001, -0.0001}, {1.0000009999999997, -0.00010000000000000003}},
 {{1.000001, -0.00001}, {1.0000009999999997, -0.00001}},
 {{1.000001, -1.e-6}, {1.000001000000001, -1.0000000000000002e-6}},
 {{1.000001, -1.e-7}, {1.0000010000000001, -9.999999999999948e-8}},
 {{1.000001, -1.e-8}, {1.0000010000000001, -1.0000000000000096e-8}},
 {{1.000001, -1.e-9}, {1.0000009999999993, -1.000000000000666e-9}},
 {{1.000001, -1.e-10}, {1.0000010000000006, -9.999999999962108e-11}},
 {{1.000001, 0.}, {1.0000010000000001, -2.320811307707067e-22}},
 {{1.000001, 0.1}, {1.0000010000000001, 0.09999999999999999}},
 {{1.000001, 0.01}, {1.0000010000000004, 0.01}},
 {{1.000001, 0.001}, {1.0000010000000001, 0.001}},
 {{1.000001, 0.0001}, {1.0000009999999997, 0.00010000000000000003}},
 {{1.000001, 0.00001}, {1.0000009999999997, 0.00001}},
 {{1.000001, 1.e-6}, {1.000001000000001, 1.0000000000000002e-6}},
 {{1.000001, 1.e-7}, {1.0000010000000001, 9.999999999999948e-8}},
 {{1.000001, 1.e-8}, {1.0000010000000001, 1.0000000000000096e-8}},
 {{1.000001, 1.e-9}, {1.0000009999999993, 1.000000000000666e-9}},
 {{1.000001, 1.e-10}, {1.0000010000000006, 9.999999999962108e-11}},
 {{1.000001, 0.}, {1.0000010000000001, -2.320811307707067e-22}},
 {{1.0000001, -0.1}, {1.0000001000000003, -0.1}},
 {{1.0000001, -0.01}, {1.0000001000000003, -0.01}},
 {{1.0000001, -0.001}, {1.0000000999999994, -0.0009999999999999998}},
 {{1.0000001, -0.0001}, {1.0000000999999998, -0.0001}},
 {{1.0000001, -0.00001}, {1.0000000999999998, -0.00001}},
 {{1.0000001, -1.e-6}, {1.0000001000000007, -1.e-6}},
 {{1.0000001, -1.e-7}, {1.0000001, -1.0000000000000011e-7}},
 {{1.0000001, -1.e-8}, {1.0000001000000012, -1.0000000000000007e-8}},
 {{1.0000001, -1.e-9}, {1.0000000999999994, -9.999999999999246e-10}},
 {{1.0000001, -1.e-10}, {1.0000001000000012, -1.0000000000002755e-10}},
 {{1.0000001, 0.}, {1.0000001000000003, 9.399415714022902e-23}},
 {{1.0000001, 0.1}, {1.0000001000000003, 0.1}},
 {{1.0000001, 0.01}, {1.0000001000000003, 0.01}},
 {{1.0000001, 0.001}, {1.0000000999999994, 0.0009999999999999998}},
 {{1.0000001, 0.0001}, {1.0000000999999998, 0.0001}},
 {{1.0000001, 0.00001}, {1.0000000999999998, 0.00001}},
 {{1.0000001, 1.e-6}, {1.0000001000000007, 1.e-6}},
 {{1.0000001, 1.e-7}, {1.0000001, 1.0000000000000011e-7}},
 {{1.0000001, 1.e-8}, {1.0000001000000012, 1.0000000000000007e-8}},
 {{1.0000001, 1.e-9}, {1.0000000999999994, 9.999999999999246e-10}},
 {{1.0000001, 1.e-10}, {1.0000001000000012, 1.0000000000002755e-10}},
 {{1.0000001, 0.}, {1.0000001000000003, 9.399415714022902e-23}},
 {{1.00000001, -0.1}, {1.0000000099999995, -0.09999999999999998}},
 {{1.00000001, -0.01}, {1.0000000100000008, -0.010000000000000004}},
 {{1.00000001, -0.001}, {1.0000000099999995, -0.001}},
 {{1.00000001, -0.0001}, {1.0000000099999995, -0.00010000000000000002}},
 {{1.00000001, -0.00001}, {1.0000000100000004, -0.00001}},
 {{1.00000001, -1.e-6}, {1.0000000100000004, -1.e-6}},
 {{1.00000001, -1.e-7}, {1.000000009999999, -9.999999999999997e-8}},
 {{1.00000001, -1.e-8}, {1.0000000100000004, -9.999999999999997e-9}},
 {{1.00000001, -1.e-9}, {1.0000000100000013, -1.0000000000000038e-9}},
 {{1.00000001, -1.e-10}, {1.0000000100000004, -9.999999999999909e-11}},
 {{1.00000001, 0.}, {1.0000000100000004, 1.3128671115997504e-24}},
 {{1.00000001, 0.1}, {1.0000000099999995, 0.09999999999999998}},
 {{1.00000001, 0.01}, {1.0000000100000008, 0.010000000000000004}},
 {{1.00000001, 0.001}, {1.0000000099999995, 0.001}},
 {{1.00000001, 0.0001}, {1.0000000099999995, 0.00010000000000000002}},
 {{1.00000001, 0.00001}, {1.0000000100000004, 0.00001}},
 {{1.00000001, 1.e-6}, {1.0000000100000004, 1.e-6}},
 {{1.00000001, 1.e-7}, {1.000000009999999, 9.999999999999997e-8}},
 {{1.00000001, 1.e-8}, {1.0000000100000004, 9.999999999999997e-9}},
 {{1.00000001, 1.e-9}, {1.0000000100000013, 1.0000000000000038e-9}},
 {{1.00000001, 1.e-10}, {1.0000000100000004, 9.999999999999909e-11}},
 {{1.00000001, 0.}, {1.0000000100000004, 1.3128671115997504e-24}},
 {{1.000000001, -0.1}, {1.0000000009999996, -0.1}},
 {{1.000000001, -0.01}, {1.0000000009999992, -0.009999999999999998}},
 {{1.000000001, -0.001}, {1.000000001000001, -0.0009999999999999998}},
 {{1.000000001, -0.0001}, {1.0000000009999992, -0.00010000000000000002}},
 {{1.000000001, -0.00001}, {1.0000000009999996, -0.00001}},
 {{1.000000001, -1.e-6}, {1.0000000010000005, -1.e-6}},
 {{1.000000001, -1.e-7}, {1.0000000009999994, -9.999999999999998e-8}},
 {{1.000000001, -1.e-8}, {1.0000000010000005, -9.999999999999999e-9}},
 {{1.000000001, -1.e-9}, {1.000000001000001, -9.999999999999994e-10}},
 {{1.000000001, -1.e-10}, {1.0000000010000005, -1.0000000000000008e-10}},
 {{1.000000001, 0.}, {1.0000000010000005, 5.748552980097597e-25}},
 {{1.000000001, 0.1}, {1.0000000009999996, 0.1}},
 {{1.000000001, 0.01}, {1.0000000009999992, 0.009999999999999998}},
 {{1.000000001, 0.001}, {1.000000001000001, 0.0009999999999999998}},
 {{1.000000001, 0.0001}, {1.0000000009999992, 0.00010000000000000002}},
 {{1.000000001, 0.00001}, {1.0000000009999996, 0.00001}},
 {{1.000000001, 1.e-6}, {1.0000000010000005, 1.e-6}},
 {{1.000000001, 1.e-7}, {1.0000000009999994, 9.999999999999998e-8}},
 {{1.000000001, 1.e-8}, {1.0000000010000005, 9.999999999999999e-9}},
 {{1.000000001, 1.e-9}, {1.000000001000001, 9.999999999999994e-10}},
 {{1.000000001, 1.e-10}, {1.0000000010000005, 1.0000000000000008e-10}},
 {{1.000000001, 0.}, {1.0000000010000005, 5.748552980097597e-25}},
 {{1.0000000001, -0.1}, {1.0000000000999998, -0.09999999999999999}},
 {{1.0000000001, -0.01}, {1.0000000000999998, -0.01}},
 {{1.0000000001, -0.001}, {1.0000000001, -0.0009999999999999996}},
 {{1.0000000001, -0.0001}, {1.0000000000999996, -0.0001}},
 {{1.0000000001, -0.00001}, {1.0000000001000005, -0.00001}},
 {{1.0000000001, -1.e-6}, {1.0000000001, -1.e-6}},
 {{1.0000000001, -1.e-7}, {1.0000000000999993, -9.999999999999997e-8}},
 {{1.0000000001, -1.e-8}, {1.0000000001000005, -1.e-8}},
 {{1.0000000001, -1.e-9}, {1.000000000100001, -1.0000000000000003e-9}},
 {{1.0000000001, -1.e-10}, {1.0000000001000005, -1.0000000000000006e-10}},
 {{1.0000000001, 0.}, {1.0000000001000005, 3.54633314620027e-26}},
 {{1.0000000001, 0.1}, {1.0000000000999998, 0.09999999999999999}},
 {{1.0000000001, 0.01}, {1.0000000000999998, 0.01}},
 {{1.0000000001, 0.001}, {1.0000000001, 0.0009999999999999996}},
 {{1.0000000001, 0.0001}, {1.0000000000999996, 0.0001}},
 {{1.0000000001, 0.00001}, {1.0000000001000005, 0.00001}},
 {{1.0000000001, 1.e-6}, {1.0000000001, 1.e-6}},
 {{1.0000000001, 1.e-7}, {1.0000000000999993, 9.999999999999997e-8}},
 {{1.0000000001, 1.e-8}, {1.0000000001000005, 1.e-8}},
 {{1.0000000001, 1.e-9}, {1.000000000100001, 1.0000000000000003e-9}},
 {{1.0000000001, 1.e-10}, {1.0000000001000005, 1.0000000000000006e-10}},
 {{1.0000000001, 0.}, {1.0000000001000005, 3.54633314620027e-26}},
 {{1., -0.1}, {0.9999999999999996, -0.09999999999999999}},
 {{1., -0.01}, {0.9999999999999989, -0.009999999999999998}},
 {{1., -0.001}, {0.9999999999999999, -0.0010000000000000002}},
 {{1., -0.0001}, {0.9999999999999994, -0.0001}},
 {{1., -0.00001}, {0.9999999999999996, -0.00001}},
 {{1., -1.e-6}, {1., -1.e-6}}, {{1., -1.e-7},
  {0.9999999999999993, -9.999999999999998e-8}},
 {{1., -1.e-8}, {1., -1.e-8}}, {{1., -1.e-9}, {1., -1.e-9}},
 {{1., -1.e-10}, {1., -1.e-10}}, {{1., 0.}, {0.999999999999995, 0.}},
 {{1., 0.1}, {0.9999999999999996, 0.09999999999999999}},
 {{1., 0.01}, {0.9999999999999989, 0.009999999999999998}},
 {{1., 0.001}, {0.9999999999999999, 0.0010000000000000002}},
 {{1., 0.0001}, {0.9999999999999994, 0.0001}},
 {{1., 0.00001}, {0.9999999999999996, 0.00001}},
 {{1., 1.e-6}, {1., 1.e-6}}, {{1., 1.e-7},
  {0.9999999999999993, 9.999999999999998e-8}}, {{1., 1.e-8}, {1., 1.e-8}},
 {{1., 1.e-9}, {1., 1.e-9}}, {{1., 1.e-10}, {1., 1.e-10}},
 {{1., 0.}, {0.999999999999995, 0.}}
};

TEST_CASE("test_values_close_to_unity")
{
   using polylogarithm::Li2;
   using polylogarithm::Li3;
   using polylogarithm::Li4;
   using polylogarithm::Li5;
   using polylogarithm::Li6;
   using polylogarithm::Li;

   const double eps = 1e-8;

   for (const auto& v: values_close_to_unity) {
      const auto z = v.first;
      const auto Li100 = v.second;

      INFO("z = " << z);
      CHECK_CLOSE_COMPLEX(Li2(z), Li(2,z), eps);
      CHECK_CLOSE_COMPLEX(Li3(z), Li(3,z), eps);
      CHECK_CLOSE_COMPLEX(Li4(z), Li(4,z), eps);
      CHECK_CLOSE_COMPLEX(Li5(z), Li(5,z), eps);
      CHECK_CLOSE_COMPLEX(Li6(z), Li(6,z), eps);
      CHECK_CLOSE_COMPLEX(Li100, Li(100,z), eps);
   }
}

TEST_CASE("test_complex_fixed_values")
{
   const auto eps = 1e-8;
   const int ni[] = {-2, -1, 0, 1, 2, 3, 4, 5, 6, 100};

   for (const auto n: ni) {
      const std::string filename(std::string(TEST_DATA_DIR) + PATH_SEPARATOR + "Li" + std::to_string(n) + ".txt");
      const auto values = polylogarithm::test::read_from_file<double>(filename);

      for (auto v: values) {
         const auto z = v.first;
         const auto li_expected = v.second;
         INFO("n = " << n << ", z = " << z);
         CHECK_CLOSE_COMPLEX(polylogarithm::Li(n,z), li_expected, eps);
      }
   }
}
