#include <math.h>

/*
  Dilogarithm function used by the BaBar collaboration.
  Comment:
  CERN      C304      VERSION    29/07/71 DILOG        59                C

  Translated to C by Alexander Voigt
*/
double babar_dilog(double X)
{
   double A, B, T, S, Y;
   double Z = -1.64493406684822;

   if (X < -1.0) goto L1;
   if (X <= 0.5) goto L2;
   if (X == 1.0) goto L3;
   if (X <= 2.0) goto L4;

   Z = 3.2898681336964;

 L1:
   T = 1.0/X;
   S = -0.5;
   Y = log(fabs(X));
   Z = Z - 0.5*Y*Y;
   goto L5;

 L2:
   T = X;
   S = 0.5;
   Z = 0.0;
   goto L5;

 L3:
   return 1.64493406684822;

 L4:
   T = 1.0 - X;
   S = -0.5;
   Z = 1.64493406684822 - log(X)*log(fabs(T));

 L5:
   Y = 2.66666666666666*T + 0.66666666666666;
   B =           0.000000000000001;
   A = Y*B     + 0.000000000000004;
   B = Y*A - B + 0.000000000000011;
   A = Y*B - A + 0.000000000000037;
   B = Y*A - B + 0.000000000000121;
   A = Y*B - A + 0.000000000000398;
   B = Y*A - B + 0.000000000001312;
   A = Y*B - A + 0.000000000004342;
   B = Y*A - B + 0.000000000014437;
   A = Y*B - A + 0.000000000048274;
   B = Y*A - B + 0.000000000162421;
   A = Y*B - A + 0.000000000550291;
   B = Y*A - B + 0.000000001879117;
   A = Y*B - A + 0.000000006474338;
   B = Y*A - B + 0.000000022536705;
   A = Y*B - A + 0.000000079387055;
   B = Y*A - B + 0.000000283575385;
   A = Y*B - A + 0.000001029904264;
   B = Y*A - B + 0.000003816329463;
   A = Y*B - A + 0.000014496300557;
   B = Y*A - B + 0.000056817822718;
   A = Y*B - A + 0.000232002196094;
   B = Y*A - B + 0.001001627496164;
   A = Y*B - A + 0.004686361959447;
   B = Y*A - B + 0.024879322924228;
   A = Y*B - A + 0.166073032927855;
   A = Y*A - B + 1.93506430086996;

   return S*T*(A-B)+Z;
}
